[scenario]
    id=20_Back_in_Town_Again
    next_scenario=21_Epilogue
    name=_"Back in Town. Again." # displayed scenario name
    map_data="{~add-ons/Revenge_of_the_Rogue/maps/20_Back_in_Town_Again.map}"
    {DEFAULT_SCHEDULE}
    turns=-1
    victory_when_enemies_defeated=no

    # Rogue reinforcements
    # Turn 5 Sini & Dark Elves (top left corner)
    # Turn 15 Mermen (left sea camp)
    # Turn 25 Dwarven Doors folk and Gyphons (bottom middle road)
    # Turn 35 Wesnoth (right corner camp)
    # Turn 45 Elves + Woses (bottom left)
    # Turn 50 Khalifate (right corner)
    # Turn 55 Falcons (top of map)
    

    # Northern reinforcements
    # Turn 10 - Dragons (top side 5)
    # Turn 20 - Saurians (swamp - side 6)
    # Turn 30 - Skeletal Dragon (top side 5)
    # Turn 40 - Drakes
    # Maybe Valda should turn into the skeletal dragon?



    [side]
        side=1
        controller="human"
	team_name=1 # used to determine which side is enemy or allied
	# wmllint: local spelling foo
	user_team_name= _ "Rogues" # visible to the user

	##:: Leader Info
	type=Rogue
	id=Edwin
	name=_"Edwin"
	gender=male
	canrecruit=yes
	unrenamable=true
        shroud=no
	##:: Gold and Income
	{GOLD 400 200 100}
	{INCOME 10 5 3}
        [unit]
            type=Longbowman
            side=1
            x=25
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Longbowman
            side=1
            x=25
            y=19
            placement=map_passable
        [/unit]
        [unit]
            type=Longbowman
            side=1
            x=36
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Longbowman
            side=1
            x=36
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=27
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=29
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=33
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=25
            y=16
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=31
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=33
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=27
            y=19
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=25
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Longbowman
            side=1
            x=31
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=36
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=36
            y=15
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=35
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=29
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=26
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Javelineer
            side=1
            x=25
            y=14
            placement=map_passable
        [/unit]
        [unit]
            type=Javelineer
            side=1
            x=28
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Pikeman
            side=1
            x=36
            y=14
            placement=map_passable
        [/unit]
        [unit]
            type=Pikeman
            side=1
            x=26
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Swordsman
            side=1
            x=30
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Swordsman
            side=1
            x=32
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Trapper
            side=1
            x=25
            y=15
            placement=map_passable
        [/unit]
        [unit]
            type=Poacher
            side=1
            x=25
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Thug
            side=1
            x=36
            y=16
            placement=map_passable
        [/unit]
        [unit]
            type=Thug
            side=1
            x=25
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Thug
            side=1
            x=30
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=32
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=34
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Javelineer
            side=1
            x=34
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Pikeman
            side=1
            x=35
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Spearman
            side=1
            x=28
            y=12
            placement=map_passable
        [/unit]
        [unit]
            type=Longbowman
            side=1
            x=29
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Longbowman
            side=1
            x=33
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Trapper
            side=1
            x=33
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Trapper
            side=1
            x=35
            y=14
            placement=map_passable
        [/unit]
        [unit]
            type=Bandit
            side=1
            x=27
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Swordsman
            side=1
            x=30
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=26
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=27
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=26
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=27
            y=18
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=28
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=29
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=31
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=33
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=35
            y=17
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=35
            y=16
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=35
            y=15
            placement=map_passable
        [/unit]
        [unit]
            type=Peasant
            side=1
            x=26
            y=15
            placement=map_passable
        [/unit]
        [unit]
            type=Bowman
            side=1
            x=26
            y=14
            placement=map_passable
        [/unit]
        [unit]
            type=Bowman
            side=1
            x=26
            y=13
            placement=map_passable
        [/unit]
        [unit]
            type=Footpad
            side=1
            x=16
            y=5
            placement=map_passable
        [/unit]
        [unit]
            type=Footpad
            side=1
            x=17
            y=5
            placement=map_passable
        [/unit]
        [unit]
            type=Footpad
            side=1
            x=18
            y=4
            placement=map_passable
        [/unit]
        [unit]
            type=Footpad
            side=1
            x=17
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Footpad
            side=1
            x=16
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Footpad
            side=1
            x=18
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Scout
            side=1
            x=13
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Scout
            side=1
            x=14
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Scout
            side=1
            x=18
            y=5
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Scout
            side=1
            x=17
            y=7
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Ulfserker
            side=1
            x=19
            y=5
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Ulfserker
            side=1
            x=15
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Elvish Shaman
            side=1
            x=19
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Elvish Scout
            side=1
            x=19
            y=6
            placement=map_passable
        [/unit]
        [unit]
            type=Elvish Scout
            side=1
            x=13
            y=5
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Steelclad
            side=1
            x=15
            y=7
            placement=map_passable
        [/unit]
        [unit]
            type=Dwarvish Fighter
            side=1
            x=18
            y=7
            placement=map_passable
        [/unit]
        [unit]
            type=Ruffian
            side=1
            x=15
            y=3
            placement=map_passable
        [/unit]
        [unit]
            type=Ruffian
            side=1
            x=16
            y=3
            placement=map_passable
        [/unit]
        [unit]
            type=Thug
            side=1
            x=16
            y=4
            placement=map_passable
        [/unit]
        [unit]
            type=Woodsman
            side=1
            x=15
            y=5
            placement=map_passable
        [/unit]
        [unit]
            type=Woodsman
            side=1
            x=17
            y=4
            placement=map_passable
        [/unit]
        [unit]
            type=Thief
            side=1
            x=14
            y=5
            placement=map_passable
        [/unit]



        [village]
            x=28
            y=13
        [/village]
        [village]
            x=34
            y=13
        [/village]
        [village]
            x=28
            y=16
        [/village]
        [village]
            x=34
            y=16
        [/village]
        [village]
            x=25
            y=9
        [/village]
        [village]
            x=19
            y=16
        [/village]
        [village]
            x=41
            y=14
        [/village]
        [village]
            x=41
            y=21
        [/village]
        [village]
            x=25
            y=9
        [/village]
        [village]
            x=22
            y=23
        [/village]
        [village]
            x=47
            y=12
        [/village]
        [village]
            x=18
            y=3
        [/village]
        [village]
            x=15
            y=7
        [/village]
        [village]
            x=19
            y=7
        [/village]
        [village]
            x=23
            y=1
        [/village]
        [village]
            x=29
            y=5
        [/village]
    [/side]

    [side]
	##:: Side Info
	side=2
	controller=ai
	team_name=2
	user_team_name= _ "Northerners"

	##:: Leader Info
	type=Lich
	id=Valda
	name=_"Valda"
        gender=female
	canrecruit=yes
	unrenamable=true

	##:: Recruit List
	recruit=Dark Adept,Ghost,Orcish Archer,Orcish Grunt,Wolf Rider,Goblin Spearman,Orcish Assassin,Troll Whelp,Vampire Bat,Skeleton,Skeleton Archer,Young Ogre,Black Mage,Ghoul,Walking Corpse,Orcish Crossbowman,Orcish Warrior
	##:: Gold and Income

	{GOLD 50 100 200}
	{INCOME 3 5 10}
        [unit]
            type=Dark Adept
            gender=female
            side=2
            x=53
            y=2
            [status]
                guardian=yes
            [/status]
        [/unit]
        [unit]
            type=Dark Adept
            gender=female
            side=2
            x=55
            y=2
            [status]
                guardian=yes
            [/status]
        [/unit]
    [/side]

    [side]
	##:: Side Info
	side=3
	controller=ai
	team_name=2
	user_team_name= _ "Northerners"

	##:: Leader Info
	type="Death Knight"
	id=Than Mot
	name=_"Than Mot"
	canrecruit=yes
	unrenamable=true
        recruit=Skeleton,Skeleton Archer,Ghost,Ghoul,Walking Corpse
	{GOLD 100 200 300}
	{INCOME 3 5 10}

        [unit]
            type=Chocobone
            side=3
            x=27
            y=11
        [/unit]
        [unit]
            type=Shadow
            side=3
            x=30
            y=11
        [/unit]
        [unit]
            type=Nightgaunt
            side=3
            x=34
            y=11
        [/unit]
        [unit]
            type=Wraith
            side=3
            x=35
            y=12
        [/unit]
        [unit]
            type=Spectre
            side=3
            x=37
            y=14
        [/unit]
        [unit]
            type=Necrophage
            side=3
            x=27
            y=20
        [/unit]
        [unit]
            type=Ghast
            side=3
            x=25
            y=20
        [/unit]
        [unit]
            type=Deathblade
            side=3
            x=24
            y=19
        [/unit]
        [unit]
            type=Revenant
            side=3
            x=38
            y=17
        [/unit]
        [unit]
            type=Draug
            side=3
            x=31
            y=10
        [/unit]
        [unit]
            type=Bone Shooter
            side=3
            x=26
            y=10
        [/unit]
        [unit]
            type=Banebow
            side=3
            x=38
            y=17
        [/unit]
        [unit]
            type=Skeleton
            side=3
            x=29
            y=11
        [/unit]
        [unit]
            type=Skeleton
            side=3
            x=31
            y=11
        [/unit]
        [unit]
            type=Skeleton
            side=3
            x=33
            y=11
        [/unit]
        [unit]
            type=Skeleton
            side=3
            x=36
            y=11
        [/unit]
        [unit]
            type=Skeleton
            side=3
            x=31
            y=19
        [/unit]
    [/side]

    [side]
	##:: Side Info
	side=4
	controller=ai
	team_name=2
	user_team_name= _ "Northerners"

	##:: Leader Info
	type="Orcish Sovereign"
	id=Regzdur
	name=_"Regzdur"
	canrecruit=yes
	unrenamable=true
        recruit=Orcish Archer,Orcish Grunt,Wolf Rider,Goblin Spearman,Orcish Assassin,Troll Whelp
	{GOLD 150 200 250}
	{INCOME 3 5 10}
        [unit]
            type=Orcish Warrior
            side=4
            x=24
            y=10
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=23
            y=15
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=22
            y=17
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=23
            y=15
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=25
            y=21
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=28
            y=20
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=30
            y=19
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=34
            y=19
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=38
            y=18
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=38
            y=16
        [/unit]
        [unit]
            type=Orcish Warrior
            side=4
            x=38
            y=13
        [/unit]
        [unit]
            type=Orcish Slayer
            side=4
            x=22
            y=12
        [/unit]
        [unit]
            type=Orcish Slayer
            side=4
            x=28
            y=10
        [/unit]
        [unit]
            type=Orcish Slayer
            side=4
            x=38
            y=14
        [/unit]
        [unit]
            type=Orcish Slayer
            side=4
            x=36
            y=19
        [/unit]
        [unit]
            type=Orcish Slayer
            side=4
            x=29
            y=19
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=33
            y=20
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=23
            y=14
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=29
            y=20
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=37
            y=19
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=38
            y=15
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=37
            y=12
        [/unit]
        [unit]
            type=Orcish Crossbowman
            side=4
            x=30
            y=10
        [/unit]
        [unit]
            type=Goblin Rouser
            side=4
            x=24
            y=16
        [/unit]
        [unit]
            type=Goblin Impaler
            side=4
            x=24
            y=17
        [/unit]
        [unit]
            type=Goblin Impaler
            side=4
            x=24
            y=15
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=24
            y=13
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=24
            y=12
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=26
            y=19
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=28
            y=19
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=30
            y=18
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=32
            y=18
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=34
            y=18
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=36
            y=18
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=37
            y=18
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=37
            y=17
        [/unit]
        [unit]
            type=Goblin Spearman
            side=4
            x=37
            y=16
        [/unit]
        [unit]
            type=Great Troll
            side=4
            x=37
            y=13
        [/unit]
        [unit]
            type=Troll Warrior
            side=4
            x=24
            y=14
        [/unit]
        [unit]
            type=Troll Hero
            side=4
            x=24
            y=18
        [/unit]
        [unit]
            type=Troll Shaman
            side=4
            x=28
            y=11
        [/unit]
        [unit]
            type=Troll Rocklobber
            side=4
            x=32
            y=11
        [/unit]
        [unit]
            type=Troll Rocklobber
            side=4
            x=38
            y=19
        [/unit]
        [unit]
            type=Troll Rocklobber
            side=4
            x=36
            y=10
        [/unit]
        [unit]
            type=Troll
            side=4
            x=29
            y=10
        [/unit]
        [unit]
            type=Troll
            side=4
            x=22
            y=15
        [/unit]
        [unit]
            type=Troll
            side=4
            x=34
            y=20
        [/unit]
        [unit]
            type=Troll Whelp
            side=4
            x=33
            y=21
        [/unit]
        [unit]
            type=Troll Whelp
            side=4
            x=35
            y=19
        [/unit]
        [unit]
            type=Troll Whelp
            side=4
            x=24
            y=11
        [/unit]
        [unit]
            type=Troll Whelp
            side=4
            x=26
            y=11
        [/unit]
        [unit]
            type=Troll Whelp
            side=4
            x=33
            y=19
        [/unit]
    [/side]

    [side]
	##:: Side Info
	side=5
	controller=ai
	team_name=2
	user_team_name= _ "Northerners"
	type=Fire Dragon
        name="Lohikäärme"
        id=dragonlord
        hidden=yes
        x=recall
        y=recall
        can_recruit=yes
        recruit=Drake Burner,Drake Clasher,Drake Fighter,Drake Glider,Fire Dragon
	{GOLD 150 200 250}
	{INCOME 3 5 10}
    [/side]

    [side]
	##:: Side Info
	side=6
	controller=ai
	team_name=2
	user_team_name= _ "Northerners"

	##:: Leader Info
	type=Saurian Flanker
	id=Liskot
	name=_"Liskot"
	canrecruit=yes
	unrenamable=true
        hidden=yes

	##:: Recruit List
	recruit=Saurian Augur,Saurian Skirmisher
	##:: Gold and Income
	{GOLD 150 200 250}
	{INCOME 3 5 10}
    [/side]

    {VIKKI_DEATH}
    {SINI_DEATH}
    {KARDURAS_DEATH}
    {KALLIOPE_DEATH}
    {PELAITHSTORN_DEATH}

    [event]
	name=prestart

        [set_variable]
            name=valda_life_state
            value=1
        [/set_variable]        

        [store_unit]
            kill=yes
            variable=dragon_storage
            [filter]
                id=dragonlord
            [/filter]
        [/store_unit]

        [store_unit]
            kill=yes
            variable=lizard_storage
            [filter]
                id=Liskot
            [/filter]
        [/store_unit]

        {STORE_SINI}

        {UNSTORE_KARDURAS}
        #{UNSTORE_PELAITHSTORN}
        {UNSTORE_KALLIOPE}

        [recall]
            id=Karduras
        [/recall]

        {UNSTORE_VIKKI}
        [recall]
            id=Vikki
            x=31
            y=13
        [/recall]

        {RECALL_LOYAL_ROGUES}


        [set_recruit]
            side=1
            recruit=Ruffian,Woodsman,Thief,Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Ulfserker,Dwarvish Guardsman,Dwarvish Scout,Elvish Shaman
        [/set_recruit]
        [recall]
            side=1
        [/recall]


    [/event]

    [event]
        name=last breath
        first_time_only=no
        [filter]
            id=Valda
        [/filter]
        [if]
            [variable]
                name=valda_life_state
                equals=1
            [/variable]
            [then]
                [message]
                    speaker=Valda
                    message="You will never defeat me. I am the queen of dragons."
                [/message]
                [transform_unit]
                    id=Valda
                    transform_to=Skeletal Dragon
                [/transform_unit]
                [heal_unit]
                    [filter]
                        id=Valda
                    [/filter]
                [/heal_unit]
                [set_variable]
                    name=valda_life_state
                    value=2
                [/set_variable]
            [/then]
            [else]
                [message]
                    speaker=Valda
                    message="You may have destroyed my body, but I will find a way back. I will have my revenge."
                [/message]
                [endlevel]
                    result=victory
                [/endlevel]
            [/else]
        [/if]
            
    [/event]

    [event]
        name=moveto
        [filter]
            x=31
            y=13
            id=Edwin
        [/filter]
        [message]
	    speaker=Vikki
	    message=_"You made it! Take the remaining funds and use them to reinforce the castle's defences."
	[/message]
        [gold]
            side=1
            amount=1000
        [/gold]
        [message]
            speaker=narrator
            message="Vikki gives you 1000 gold."
        [/message]
        [objectives]
            side=1
            victory_string=_"Second objective"
            [objective]
		description= _ "Clear the castle of enemies and hold the castle"
		condition=win
            [/objective]
	    [objective]
		description= _ "Death of Edwin"
		condition=lose
	    [/objective]
	    [objective]
		description= _ "Death of Vikki"
		condition=lose
	    [/objective]
	    [gold_carryover]
		bonus=yes
		carryover_percentage=40
	    [/gold_carryover]
        [/objectives]
    [/event]

    [event]
	name=start
	[message]
	    speaker=narrator
	    image=wesnoth-icon.png
	    message=_"You arrive to find the town already under siege."
	[/message]
        [message]
	    speaker=Vikki
	    message=_"Welcome home my love. We were doing pretty well. We had repaired the castle and roads, and many peasants had joined us. Sadly, it was all for nothing if we die today." 
	[/message]
        [message]
	    speaker=Edwin
	    message=_"Don't worry my love, I will break the siege. Hold on, we are coming."
	[/message]
        [message]
	    speaker=Valda
	    message=_"It is no use, you are too late to save her."
	[/message]
        [message]
	    speaker=Edwin
	    message=_"We will see about that. Charge!"
	[/message]
        [modify_unit]
            [filter]
                id=Edwin
            [/filter]
            [filter_recall]
                race=human,dwarf,elf
            [/filter_recall]
        [/modify_unit]
        [objectives]
            side=1
            victory_string=_"First objective"
            [objective]
		description= _ "Get Edwin to the Castle Keep"
		condition=win
            [/objective]
	    [objective]
		description= _ "Death of Edwin"
		condition=lose
	    [/objective]
	    [objective]
		description= _ "Death of Vikki"
		condition=lose
	    [/objective]
	    [gold_carryover]
		bonus=yes
		carryover_percentage=40
	    [/gold_carryover]
        [/objectives]
    [/event]

    [event]
	name=side 1 turn 5

        {UNSTORE_SINI}
        [recall]
            id=Sini
            x=15
            y=4
        [/recall]

        [disallow_recruit]
            type=Ruffian,Woodsman,Thief,Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Ulfserker,Dwarvish Guardsman,Dwarvish Scout
        [/disallow_recruit]

        [modify_unit]
            [filter]
                id=Edwin
            [/filter]
            [filter_recall]
                race=human,dwarf,elf
            [/filter_recall]
            extra_recruit=Ruffian,Woodsman,Thief,Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Ulfserker,Dwarvish Guardsman,Dwarvish Scout
        [/modify_unit]

        [modify_unit]
            [filter]
                id=Sini
            [/filter]
            [filter_recall]
                race=dark elf
            [/filter_recall]
            canrecruit=yes
            extra_recruit=Dark Elf Fighter,Dark Elf Enchantress,Dark Elf Hunter,Dark Elf Wizard,Dark Elf Lizard Rider,Elvish Scout
        [/modify_unit]

        {GENERIC_UNIT 1 (Dark Elf Lizard Rider) 14 4}
        {GENERIC_UNIT 1 (Dark Elf Lizard Rider) 16 4}
        {GENERIC_UNIT 1 (Dark Elf Fighter) 14 5}
        {GENERIC_UNIT 1 (Dark Elf Hunter) 16 5}

        {RECALL_LOYAL_DARK_ELVES}

	[message]
	    speaker=Sini
	    message=_"We have secured the mines."
	[/message]
	[message]
	    speaker=Edwin
	    message=_"Great, sadly there is no rest for your elves."
	[/message]
	[message]
            speaker=Kalliope
	    message=_"We rested for centuries, we are ready to defeat Valda."
	[/message]
    [/event]

    [event]
	name=side 2 turn 10
	[message]
	    speaker=Edwin
	    message=_"Surrender Valda, your siege is failing and we will soon defeat you."
	[/message]
        [unstore_unit]
            variable=dragon_storage
        [/unstore_unit]
	[message]
	    speaker=Valda
	    message=_"Ha ha, this was nothing. The real fight has not even begun. Now I am ready to reveal my life's work. I have returned dragons to the world."
	[/message]
	[message]
	    speaker=Edwin
	    message=_"If dragons were defeated before, they can be defeated again."
	[/message]

    [/event]
    [event]
	name=side 1 turn 15
        [unit]
            type=Merman Triton
            side=1
            id=Okeanos
            x=4
            y=17
            name=Okeanos
            canrecruit=yes
            extra_recruit=Mermaid Initiate,Merman Hunter,Merman Fighter
        [/unit]
        {LOYAL_UNIT 1 (Mermaid Priestess) 3 17}
        {LOYAL_UNIT 1 (Merman Warrior) 5 17}
        {LOYAL_UNIT 1 (Merman Spearman) 3 18}
        {LOYAL_UNIT 1 (Merman Hunter) 5 18}
        {LOYAL_UNIT 1 (Merman Fighter) 2 17}
        {LOYAL_UNIT 1 (Mermaid Initiate) 4 16}
        {LOYAL_UNIT 1 (Mermaid Enchantress) 4 18}
        [message]
	    speaker=Okeanos
	    message=_"We received the messager from Steward Vikki and to prove the new alliance between the Merfolk and the King on top of the Mountain, we have come to fight with you."
	[/message]
        [message]
	    speaker=Edwin
	    message=_"We will never forget the help you have shown us this day, we will scatter anyone who does not respect your waters."
	[/message]
    [/event]
    [event]
	name=side 2 turn 20
        [unit]
            type=Saurian Oracle
            side=6
            x=53
            y=18
        [/unit]
        [unit]
            type=Saurian Soothsayer
            side=6
            x=54
            y=18
        [/unit]
        [unit]
            type=Saurian Ambusher
            side=6
            x=55
            y=18
        [/unit]
        [unstore_unit]
            variable=lizard_storage
        [/unstore_unit]

	[message]
	    speaker=Valda
	    message=_"Come my lizard friends."
	[/message]

	[message]
	    speaker=Liskot
	    message=_"Hissss ... as you command Dragon Queen."
	[/message]

    [/event]
    [event]
	name=side 2 turn 28
        [message]
	    speaker=Valda
	    message=_"Call back the raiders we sent against Weldyn, we need them here now."
	[/message]
    [/event]

    [event]
	name=side 2 turn 30
        {GENERIC_UNIT 5 (Armageddon Drake) 40 1}
        {GENERIC_UNIT 5 (Drake Flameheart) 39 1}
        {GENERIC_UNIT 5 (Inferno Drake) 38 1}
        {GENERIC_UNIT 5 (Drake Warden) 37 1}
        {GENERIC_UNIT 5 (Drake Enforcer) 36 1}
        {GENERIC_UNIT 5 (Drake Blademaster) 35 1}
        {GENERIC_UNIT 5 (Drake Flare) 41 1}
        {GENERIC_UNIT 5 (Fire Drake) 42 1}
        {GENERIC_UNIT 5 (Drake Arbiter) 43 1}
        {GENERIC_UNIT 5 (Drake Thrasher) 44 1}
        {GENERIC_UNIT 5 (Drake Warrior) 45 1}
        {GENERIC_UNIT 5 (Sky Drake) 46 1}
	[message]
	    speaker=Valda
	    message=_"You will never withstand my raiders."
	[/message]
	[message]
            type=Armageddon Drake
	    message=_"Kispakrrr!"
	[/message]
        {SCROLL_TO 40 1} 
    [/event]

    [event]
	name=side 1 turn 25
        {NAMED_LOYAL_UNIT 1 (Gryphon Master) 33 26 (Kanahaukka) ("Kanahaukka")}
        {LOYAL_UNIT 1 (Gryphon Rider) 32 25}
        {LOYAL_UNIT 1 (Gryphon Rider) 34 25}
        {LOYAL_UNIT 1 (Gryphon Rider) 33 27}
        {LOYAL_UNIT 1 (Dwarvish Runemaster) 30 26}
        {LOYAL_UNIT 1 (Dwarvish Stalwart) 30 27}
        {LOYAL_UNIT 1 (Dwarvish Steelclad) 30 28}
        {LOYAL_UNIT 1 (Dwarvish Fighter) 29 29}
        {LOYAL_UNIT 1 (Dwarvish Fighter) 29 30}
        {LOYAL_UNIT 1 (Dwarvish Runesmith) 30 29}
        {LOYAL_UNIT 1 (Gryphon Rider) 27 29}
        {LOYAL_UNIT 1 (Gryphon Rider) 24 27}
        {LOYAL_UNIT 1 (Gryphon Rider) 35 29}
        {LOYAL_UNIT 1 (Gryphon Rider) 34 26}
        [message]
	    speaker=Kanahaukka
	    message=_"We got the message from Steward Vikki, however, you seem to have started already. It is not a fight without the Dwarves of Dwarven Doors."
	[/message]
        [message]
	    speaker=Edwin
	    message=_"Indeed, thanks for coming."
	[/message]
    [/event]

    [event]
	name=side 1 turn 35
        {NAMED_LOYAL_UNIT 1 (Grand Knight) 58 28 (Robin) ("Sir Robin")}
        {LOYAL_UNIT 1 (Knight) 58 27}
        {LOYAL_UNIT 1 (Lancer) 57 28}
        {LOYAL_UNIT 1 (Paladin) 57 29}
        {LOYAL_UNIT 1 (Knight) 58 29}
        {LOYAL_UNIT 1 (Lancer) 59 29}
        {LOYAL_UNIT 1 (Paladin) 59 28}
        {LOYAL_UNIT 1 (Horseman) 57 27}
        {LOYAL_UNIT 1 (Horseman) 56 27}
        {LOYAL_UNIT 1 (Horseman) 56 28}
        {LOYAL_UNIT 1 (Horseman) 56 29}
        {LOYAL_UNIT 1 (Horseman) 57 30}
        {LOYAL_UNIT 1 (Horseman) 58 30}
        {LOYAL_UNIT 1 (Horseman) 59 30}
        [message]
	    speaker=Robin
	    message=_"Greetings men of the mountain. We are Knights of Wesnoth, we have been tracking a raiding party of drakes. We can see they came to this battle. We will join your fight."
	[/message]
        [message]
	    speaker=Edwin
	    message=_"We are very grateful for your help Sir."
	[/message]
    [/event]

    [event]
	name=side 1 turn 45
        {NAMED_LOYAL_UNIT 1 (Elvish Marshal) 11 24 (Tammet) ("Tammet")}
        {LOYAL_UNIT 1 (Ancient Wose) 11 26}
        {LOYAL_UNIT 1 (Elder Wose) 10 26}
        {LOYAL_UNIT 1 (Elder Wose) 12 26}
        {LOYAL_UNIT 1 (Wose) 10 25}
        {LOYAL_UNIT 1 (Wose) 11 25}
        {LOYAL_UNIT 1 (Wose) 12 25}
        {LOYAL_UNIT 1 (Elvish Sharpshooter) 10 27}
        {LOYAL_UNIT 1 (Elvish Avenger) 11 27}
        {LOYAL_UNIT 1 (Elvish Champion) 12 24}
        {LOYAL_UNIT 1 (Elvish Ranger) 11 25}
        {LOYAL_UNIT 1 (Elvish Marksman) 10 22}
        {LOYAL_UNIT 1 (Elvish Archer) 11 23}
        {LOYAL_UNIT 1 (Elvish Archer) 10 23}
        {LOYAL_UNIT 1 (Elvish Fighter) 12 23}
        {LOYAL_UNIT 1 (Elvish Fighter) 13 24}
        {LOYAL_UNIT 1 (Elvish Hero) 10 24}
        [message]
	    speaker=Tammet
	    message=_"We have heard of your discovery of our lost tribe of Elves, we come to support you." 
	[/message]
        [message]
	    speaker=Edwin
	    message=_"Thanks, we need all the help you can muster."
	[/message]
    [/event]

    [event]
	name=side 1 turn 50
        {NAMED_LOYAL_UNIT 1 (Khalid) 60 15 (Ostara) ("Ostara")}
        {LOYAL_UNIT 1 (Shuja) 60 9}
        {LOYAL_UNIT 1 (Rasikh) 60 10}
        {LOYAL_UNIT 1 (Mighwar) 60 11}
        {LOYAL_UNIT 1 (Batal) 60 12}
        {LOYAL_UNIT 1 (Mufariq) 60 13}
        {LOYAL_UNIT 1 (Hadaf) 60 14}
        {LOYAL_UNIT 1 (Tineen) 60 16}
        {LOYAL_UNIT 1 (Hadaf) 60 17}
        {LOYAL_UNIT 1 (Jawal) 60 18}
        {LOYAL_UNIT 1 (Ghazi) 60 19}
        {LOYAL_UNIT 1 (Mudafi) 60 20}
        {LOYAL_UNIT 1 (Tabib) 60 21}
        {LOYAL_UNIT 1 (Monawish) 59 11}
        {LOYAL_UNIT 1 (Muharib) 59 12}
        {LOYAL_UNIT 1 (Faris) 59 13}
        {LOYAL_UNIT 1 (Qanas) 59 14}
        {LOYAL_UNIT 1 (Saree) 59 15}
        {LOYAL_UNIT 1 (Arif) 59 16}
        {LOYAL_UNIT 1 (Hakim) 59 17}
        {LOYAL_UNIT 1 (Jundi) 59 18}
        {LOYAL_UNIT 1 (Khaiyal) 59 19}
        {LOYAL_UNIT 1 (Naffat) 59 20}
        {LOYAL_UNIT 1 (Rami) 59 21}
        {LOYAL_UNIT 1 (Rami) 58 20}

        [message]
	    speaker=Ostara
	    message=_"We have been travelling since we heard of your campaign. Long ago, we were allies and traded with the mountain men and you may not remember this but Vikki is my distant cousin."
	[/message]
        [message]
	    speaker=Vikki
	    message=_"Thanks, I didn't know we were kinsmen, I was forced from my home as a child and much has been forgotten or lost."
	[/message]
        [message]
	    speaker=Ostara
	    message=_"Well then, there is much that we can tell you, but first we must throw these invaders off the mountain." 
	[/message]
    [/event]

    [event]
	name=side 1 turn 60
        [message]
	    speaker=Sini
	    message=_"Now it is time to finish this evil once and for all. Birds of the mountain, come to our aid."
	[/message]
        {LOYAL_UNIT 1 (Elder Falcon) 23 1}
        {LOYAL_UNIT 1 (Elder Falcon) 24 1}
        {LOYAL_UNIT 1 (Elder Falcon) 25 1}
        {LOYAL_UNIT 1 (Elder Falcon) 26 1}
        {LOYAL_UNIT 1 (Elder Falcon) 27 1}
        {LOYAL_UNIT 1 (Elder Falcon) 28 1}
        {LOYAL_UNIT 1 (Elder Falcon) 29 1}
        {LOYAL_UNIT 1 (Elder Falcon) 30 1}
        {LOYAL_UNIT 1 (Elder Falcon) 31 1}
        {LOYAL_UNIT 1 (Elder Falcon) 32 1}
        {LOYAL_UNIT 1 (Elder Falcon) 33 1}
        {LOYAL_UNIT 1 (Elder Falcon) 34 1}
        {LOYAL_UNIT 1 (Elder Falcon) 35 1}
        {LOYAL_UNIT 1 (Elder Falcon) 36 1}
        {LOYAL_UNIT 1 (Elder Falcon) 37 1}
        {LOYAL_UNIT 1 (Elder Falcon) 38 1}
        {LOYAL_UNIT 1 (Elder Falcon) 39 1}
        {LOYAL_UNIT 1 (Elder Falcon) 40 1}
        {LOYAL_UNIT 1 (Elder Falcon) 41 1}
        {LOYAL_UNIT 1 (Elder Falcon) 42 1}
        {LOYAL_UNIT 1 (Elder Falcon) 43 1}
        {LOYAL_UNIT 1 (Falcon) 23 2}
        {LOYAL_UNIT 1 (Falcon) 24 2}
        {LOYAL_UNIT 1 (Falcon) 25 2}
        {LOYAL_UNIT 1 (Falcon) 26 2}
        {LOYAL_UNIT 1 (Falcon) 27 2}
        {LOYAL_UNIT 1 (Falcon) 28 2}
        {LOYAL_UNIT 1 (Falcon) 29 2}
        {LOYAL_UNIT 1 (Falcon) 30 2}
        {LOYAL_UNIT 1 (Falcon) 31 2}
        {LOYAL_UNIT 1 (Falcon) 32 2}
        {LOYAL_UNIT 1 (Falcon) 33 2}
        {LOYAL_UNIT 1 (Falcon) 34 2}
        {LOYAL_UNIT 1 (Falcon) 35 2}
        {LOYAL_UNIT 1 (Falcon) 36 2}
        {LOYAL_UNIT 1 (Falcon) 37 2}
        {LOYAL_UNIT 1 (Falcon) 38 2}
        {LOYAL_UNIT 1 (Falcon) 39 2}
        {LOYAL_UNIT 1 (Falcon) 40 2}
        {LOYAL_UNIT 1 (Falcon) 41 2}
        {LOYAL_UNIT 1 (Falcon) 42 2}
        {LOYAL_UNIT 1 (Falcon) 43 2}
        {LOYAL_UNIT 1 (Falcon) 23 3}
        {LOYAL_UNIT 1 (Falcon) 24 3}
        {LOYAL_UNIT 1 (Falcon) 25 3}
        {LOYAL_UNIT 1 (Falcon) 26 3}
        {LOYAL_UNIT 1 (Falcon) 27 3}
        {LOYAL_UNIT 1 (Falcon) 28 3}
        {LOYAL_UNIT 1 (Falcon) 29 3}
        {LOYAL_UNIT 1 (Falcon) 30 3}
        {LOYAL_UNIT 1 (Falcon) 31 3}
        {LOYAL_UNIT 1 (Falcon) 32 3}
        {LOYAL_UNIT 1 (Falcon) 33 3}
        {LOYAL_UNIT 1 (Falcon) 34 3}
        {LOYAL_UNIT 1 (Falcon) 35 3}
        {LOYAL_UNIT 1 (Falcon) 36 3}
        {LOYAL_UNIT 1 (Falcon) 37 3}
        {LOYAL_UNIT 1 (Falcon) 38 3}
        {LOYAL_UNIT 1 (Falcon) 39 3}
        {LOYAL_UNIT 1 (Falcon) 40 3}
        {LOYAL_UNIT 1 (Falcon) 41 3}
        {LOYAL_UNIT 1 (Falcon) 42 3}
        {LOYAL_UNIT 1 (Falcon) 43 3}
    [/event]



[/scenario]